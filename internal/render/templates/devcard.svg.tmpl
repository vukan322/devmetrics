<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     width="{{.Width}}" height="{{.Height}}"
     viewBox="0 0 {{.Width}} {{.Height}}"
     role="img" aria-label="Developer metrics">
  <style>
    .card { fill: #0d1117; stroke: #30363d; stroke-width: 1; rx: 12; ry: 12; }
    .stat-card { fill: #161b22; stroke: #30363d; stroke-width: 1; rx: 6; ry: 6; }
    .title { fill: #e6edf3; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 18px; font-weight: 600; }
    .subtitle { fill: #7d8590; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 14px; }
    .stat-label { fill: #7d8590; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 12px; }
    .stat-value { fill: #e6edf3; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 15px; font-weight: 600; }
    .lang-label { fill: #e6edf3; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 12px; }
    .lang-dot { r: 4; }
    .footer { fill: #7d8590; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 11px; }
  </style>

  <rect
    class="card"
    x="8.5"
    y="8.5"
    width="{{subf (float64 .Width) 17}}"
    height="{{subf (float64 .Height) 17}}"
  />

  {{- if .AvatarURL }}
  <defs>
    <clipPath id="avatarClip">
      <circle cx="44" cy="44" r="24" />
    </clipPath>
  </defs>
  <image
    x="20"
    y="20"
    width="48"
    height="48"
    clip-path="url(#avatarClip)"
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
    href="{{.AvatarURL}}"
  />
  {{- else }}
    <circle cx="44" cy="44" r="24" fill="#161b22" />
  {{- end }}

  <text class="title" x="80" y="40">{{.Title}}</text>
  <text class="subtitle" x="80" y="62">{{.Subtitle}}</text>

  <rect class="stat-card" x="24" y="88" width="140" height="44" />
  <text class="stat-label" x="94" y="104" text-anchor="middle">Repos</text>
  <text class="stat-value" x="94" y="122" text-anchor="middle">
    {{.Repos}} pub · {{.PrivateRepos}} priv
  </text>

  <rect class="stat-card" x="179" y="88" width="108" height="44" />
  <text class="stat-label" x="233" y="104" text-anchor="middle">Stars</text>
  <text class="stat-value" x="233" y="122" text-anchor="middle">{{.Stars}}</text>

  <rect class="stat-card" x="302" y="88" width="108" height="44" />
  <text class="stat-label" x="356" y="104" text-anchor="middle">Followers</text>
  <text class="stat-value" x="356" y="122" text-anchor="middle">{{.Followers}}</text>

  <rect class="stat-card" x="425" y="88" width="108" height="44" />
  <text class="stat-label" x="479" y="104" text-anchor="middle">Contributed</text>
  <text class="stat-value" x="479" y="122" text-anchor="middle">{{.ContributedRepos}}</text>

  <rect class="stat-card" x="548" y="88" width="108" height="44" />
  <text class="stat-label" x="602" y="104" text-anchor="middle">Joined</text>
  <text class="stat-value" x="602" y="122" text-anchor="middle">{{.JoinedAgo}}</text>

  <rect class="stat-card" x="671" y="88" width="108" height="44" />
  <text class="stat-label" x="725" y="104" text-anchor="middle">Languages</text>
  <text class="stat-value" x="725" y="122" text-anchor="middle">{{.TotalLanguages}}</text>

  <text class="subtitle" x="24" y="158" style="fill: #e6edf3;">Most used languages</text>

  {{- $mainMargin := 24.0 }}
  {{- $mainWidth := 748.0 }}
  {{- $subtitleGap := 18.0 }} 
  
  {{- $startX := $mainMargin }}
  {{- $barY := 176.0 }}
  {{- $barHeight := 8.0 }}
  {{- $x := $startX }}
  {{- range $i, $lang := .Languages }}
    {{- if lt $i 10 }}
      {{- $w := mulf $mainWidth (divf $lang.Percentage 100.0) }}
      <rect x="{{$x}}" y="{{$barY}}" width="{{$w}}" height="{{$barHeight}}" fill="{{$lang.Color}}" rx="1" />
      {{- $x = addf $x $w }}
    {{- end }}
  {{- end }}

  {{- $langX := 40.0 }}
  {{- $langY := 204.0 }}
  {{- $langSpacing := 160.0 }}
  {{- $perRow := 5 }}
  {{- range $i, $lang := .Languages }}
    {{- if lt $i 10 }}
      {{- $row := divInt $i $perRow }}
      {{- $col := modInt $i $perRow }}
      {{- $currentX := addf $langX (mulf (float64 $col) $langSpacing) }}
      {{- $currentY := addf $langY (mulf (float64 $row) 20.0) }}
      <circle class="lang-dot" cx="{{$currentX}}" cy="{{addf $currentY -3.0}}" fill="{{$lang.Color}}" />
      <text class="lang-label" x="{{addf $currentX 10.0}}" y="{{$currentY}}">
        {{$lang.Name}} {{printf "%.0f" $lang.Percentage}}%
      </text>
    {{- end }}
  {{- end }}


  {{- $baseY := 250.0 }}
  {{- if le (len .Languages) 5 }}
    {{- $baseY = 230.0 }}
  {{- end }}

  <text class="subtitle" x="24" y="{{$baseY}}" style="fill: #e6edf3;">Issues &amp; pull requests</text>

  {{- $issuesTotal := addf (float64 .IssuesOpen) (float64 .IssuesClosed) }}
  
  {{- $issuesLabelY := addf $baseY 26.0 }}

  {{- if gt $issuesTotal 0.0 }}
    <text class="stat-label" x="24" y="{{$issuesLabelY}}">
      Issues ( {{.IssuesOpen}} open · {{.IssuesClosed}} closed )
    </text>
    
    {{- $ix := $mainMargin }}
    {{- $issueBarY := addf $issuesLabelY 8.0 }}
    
    {{- $openW := mulf $mainWidth (divf (float64 .IssuesOpen) $issuesTotal) }}
    <rect x="{{$ix}}" y="{{$issueBarY}}" width="{{$openW}}" height="{{$barHeight}}" rx="1" fill="#238636" />
    {{- $ix = addf $ix $openW }}
    {{- $closedW := mulf $mainWidth (divf (float64 .IssuesClosed) $issuesTotal) }}
    <rect x="{{$ix}}" y="{{$issueBarY}}" width="{{$closedW}}" height="{{$barHeight}}" rx="1" fill="#da3633" />
  {{- end }}

  {{- $prLabelY := addf $issuesLabelY 42.0 }} 
  {{- if eq $issuesTotal 0.0 }}
      {{- $prLabelY = $issuesLabelY }}
  {{- end }}

  {{- $prTotal := addf (float64 .PROpen) (addf (float64 .PRMerged) (float64 .PRClosed)) }}
  {{- if gt $prTotal 0.0 }}
    <text class="stat-label" x="24" y="{{$prLabelY}}">
      Pull requests ( {{.PROpen}} open · {{.PRMerged}} merged · {{.PRClosed}} closed )
    </text>

    {{- $px := $mainMargin }}
    {{- $prBarY := addf $prLabelY 8.0 }}
    
    {{- $prOpenW := mulf $mainWidth (divf (float64 .PROpen) $prTotal) }}
    <rect x="{{$px}}" y="{{$prBarY}}" width="{{$prOpenW}}" height="{{$barHeight}}" rx="1" fill="#238636" />
    {{- $px = addf $px $prOpenW }}
    {{- $prMergedW := mulf $mainWidth (divf (float64 .PRMerged) $prTotal) }}
    <rect x="{{$px}}" y="{{$prBarY}}" width="{{$prMergedW}}" height="{{$barHeight}}" rx="1" fill="#8957e5" />
    {{- $px = addf $px $prMergedW }}
    {{- $prClosedW := mulf $mainWidth (divf (float64 .PRClosed) $prTotal) }}
    <rect x="{{$px}}" y="{{$prBarY}}" width="{{$prClosedW}}" height="{{$barHeight}}" rx="1" fill="#da3633" />
  {{- end }}

  <text class="footer"
      x="{{divf (float64 .Width) 2.0}}"
      y="{{subf (float64 .Height) 20}}"
      text-anchor="middle">
    devmetrics · github.com/vukan322/devmetrics
  </text>
</svg>
