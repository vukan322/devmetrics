<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     width="{{.Width}}" height="{{.Height}}"
     viewBox="0 0 {{.Width}} {{.Height}}"
     role="img" aria-label="Developer metrics">
  <style>
    .card { fill: #0d1117; stroke: #30363d; stroke-width: 1; rx: 12; ry: 12; }
    .stat-card { fill: #161b22; stroke: #30363d; stroke-width: 1; rx: 6; ry: 6; }
    .title { fill: #e6edf3; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 18px; font-weight: 600; }
    .subtitle { fill: #7d8590; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 13px; }
    .stat-label { fill: #7d8590; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 12px; }
    .stat-value { fill: #e6edf3; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 14px; font-weight: 600; }
    .lang-label { fill: #e6edf3; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 12px; }
    .lang-dot { r: 4; }
    .footer { fill: #7d8590; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 11px; }
  </style>

  <rect class="card" x="0.5" y="0.5" width="{{.Width}}" height="{{.Height}}" />

  {{- if .AvatarURL }}
  <defs>
    <clipPath id="avatarClip">
      <circle cx="44" cy="44" r="24" />
    </clipPath>
  </defs>
  <image
    x="20"
    y="20"
    width="48"
    height="48"
    clip-path="url(#avatarClip)"
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
    href="{{.AvatarURL}}"
  />
  {{- else }}
    <circle cx="44" cy="44" r="24" fill="#161b22" />
  {{- end }}

  <text class="title" x="80" y="40">{{.Title}}</text>
  <text class="subtitle" x="80" y="62">{{.Subtitle}}</text>

  <rect class="stat-card" x="24" y="88" width="108" height="44" />
  <text class="stat-label" x="78" y="104" text-anchor="middle">Repos</text>
  <text class="stat-value" x="78" y="122" text-anchor="middle">{{.Repos}}</text>

  <rect class="stat-card" x="152" y="88" width="108" height="44" />
  <text class="stat-label" x="206" y="104" text-anchor="middle">Stars</text>
  <text class="stat-value" x="206" y="122" text-anchor="middle">{{.Stars}}</text>

  <rect class="stat-card" x="280" y="88" width="108" height="44" />
  <text class="stat-label" x="334" y="104" text-anchor="middle">Followers</text>
  <text class="stat-value" x="334" y="122" text-anchor="middle">{{.Followers}}</text>

  <rect class="stat-card" x="408" y="88" width="108" height="44" />
  <text class="stat-label" x="462" y="104" text-anchor="middle">Contributed</text>
  <text class="stat-value" x="462" y="122" text-anchor="middle">{{.ContributedRepos}}</text>

  <rect class="stat-card" x="536" y="88" width="108" height="44" />
  <text class="stat-label" x="590" y="104" text-anchor="middle">Joined</text>
  <text class="stat-value" x="590" y="122" text-anchor="middle">{{.JoinedAgo}}</text>

  <rect class="stat-card" x="664" y="88" width="108" height="44" />
  <text class="stat-label" x="718" y="104" text-anchor="middle">Languages</text>
  <text class="stat-value" x="718" y="122" text-anchor="middle">{{.TotalLanguages}}</text>

  <text class="subtitle" x="24" y="158" style="fill: #e6edf3;">Most used languages</text>

  {{- $margin := 26.5 }}
  {{- $svgWidth := float64 .Width }}
  {{- $availableWidth := subf $svgWidth (mulf $margin 2.0) }}
  {{- $startX := $margin }}
  {{- $barY := 176.0 }}
  {{- $height := 8.0 }}
  {{- $x := $startX }}
  {{- range $i, $lang := .Languages }}
    {{- if lt $i 10 }}
      {{- $w := mulf $availableWidth (divf $lang.Percentage 100.0) }}
      {{- $colorIdx := $i }}
      <rect x="{{$x}}" y="{{$barY}}" width="{{$w}}" height="{{$height}}" fill="{{index $.Colors $colorIdx}}" rx="1" />
      {{- $x = addf $x $w }}
    {{- end }}
  {{- end }}

  {{- $langX := 40.0 }}
  {{- $langY := 204.0 }}
  {{- $langSpacing := 160.0 }}
  {{- $perRow := 5 }}
  {{- range $i, $lang := .Languages }}
    {{- if lt $i 10 }}
      {{- $colorIdx := $i }}
      {{- $row := divInt $i $perRow }}
      {{- $col := modInt $i $perRow }}
      {{- $currentX := addf $langX (mulf (float64 $col) $langSpacing) }}
      {{- $currentY := addf $langY (mulf (float64 $row) 20.0) }}
      <circle class="lang-dot" cx="{{$currentX}}" cy="{{addf $currentY -3.0}}" fill="{{index $.Colors $colorIdx}}" />
      <text class="lang-label" x="{{addf $currentX 10.0}}" y="{{$currentY}}">
        {{$lang.Name}} {{printf "%.0f" $lang.Percentage}}%
      </text>
    {{- end }}
  {{- end }}


  <text class="subtitle" x="24" y="250" style="fill: #e6edf3;">Issues &amp; pull requests</text>

  {{- $sectionMargin := 26.5 }}
  {{- $sectionWidth := subf (float64 .Width) (mulf $sectionMargin 2.0) }}
  {{- $sectionX := $sectionMargin }}
  {{- $barHeight := 8.0 }}

  {{- $issuesTotal := addf (float64 .IssuesOpen) (float64 .IssuesClosed) }}
  {{- if gt $issuesTotal 0.0 }}
    <text class="stat-label" x="24" y="270">
      Issues ({{.IssuesOpen}} open · {{.IssuesClosed}} closed)
    </text>
    
    {{- $ix := $sectionX }}
    {{- $openW := mulf $sectionWidth (divf (float64 .IssuesOpen) $issuesTotal) }}
    <rect x="{{$ix}}" y="278" width="{{$openW}}" height="{{$barHeight}}" rx="1" fill="#22C55E" />
    {{- $ix = addf $ix $openW }}
    {{- $closedW := mulf $sectionWidth (divf (float64 .IssuesClosed) $issuesTotal) }}
    <rect x="{{$ix}}" y="278" width="{{$closedW}}" height="{{$barHeight}}" rx="1" fill="#EF4444" />
  {{- end }}

  {{- $prTotal := addf (float64 .PROpen) (addf (float64 .PRMerged) (float64 .PRClosed)) }}
  {{- if gt $prTotal 0.0 }}
    <text class="stat-label" x="24" y="305">
      Pull requests ({{.PROpen}} open · {{.PRMerged}} merged)
    </text>

    {{- $px := $sectionX }}
    {{- $prOpenW := mulf $sectionWidth (divf (float64 .PROpen) $prTotal) }}
    <rect x="{{$px}}" y="313" width="{{$prOpenW}}" height="{{$barHeight}}" rx="1" fill="#FACC15" />
    {{- $px = addf $px $prOpenW }}
    {{- $prMergedW := mulf $sectionWidth (divf (float64 .PRMerged) $prTotal) }}
    <rect x="{{$px}}" y="313" width="{{$prMergedW}}" height="{{$barHeight}}" rx="1" fill="#22C55E" />
    {{- $px = addf $px $prMergedW }}
    {{- $prClosedW := mulf $sectionWidth (divf (float64 .PRClosed) $prTotal) }}
    <rect x="{{$px}}" y="313" width="{{$prClosedW}}" height="{{$barHeight}}" rx="1" fill="#EF4444" />
  {{- end }}

  <text class="footer" x="{{divf (float64 .Width) 2.0}}" y="{{.Height}}" dy="-12" text-anchor="middle">
    devmetrics · github.com/vukan322/devmetrics
  </text>
</svg>
